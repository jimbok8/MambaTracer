//Path tracer
while(true)
{
  camera ray             //rayCount
  for(int i = 0; i<5; i++)  
  {
    tracekernel(rays[], intersection[], primitives[], bvh, hitCount, rayCount);    
    shadeBackground();
    if(!(hitCount>0))
      break;
      
    /*
      "in case you hit light directly, since light doesn't reflect" 
    */
    directlyHitLight(intersection[], material[], accum[]);          
    
    /*
      "this methods are trivial hence can fit in one kernel"
       sample_brdf
       sample_next_ray
       calculate_brdf_factor
       calculate_brdf_pdf
       compact_ray
    */    
    randomWalk(intersection[], rays[], material[], accum[]);                
  }
  updateFrame()
}
   
